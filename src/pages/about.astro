---
import AboutHeroImage from "../assets/blog-placeholder-about.jpg";
import Layout from "../layouts/AboutLayout.astro";
import * as simpleIcons from "simple-icons";

// === Solved.ac (백준) ===
const handle = "olly123";
const res = await fetch(`https://solved.ac/api/v3/user/show?handle=${handle}`);
const data = await res.json();

// === Kaggle ===
const KAGGLE_USERNAME = import.meta.env.KAGGLE_USERNAME || process.env.KAGGLE_USERNAME;
const KAGGLE_KEY = import.meta.env.KAGGLE_KEY || process.env.KAGGLE_KEY;
const kaggleUser = "kyoungteakim";

let kaggleData: any = null;
if (KAGGLE_USERNAME && KAGGLE_KEY) {
  try {
    const kaggleRes = await fetch(`https://www.kaggle.com/api/v1/users/${kaggleUser}`, {
      headers: {
        'Authorization': 'Basic ' + btoa(`${KAGGLE_USERNAME}:${KAGGLE_KEY}`)
      }
    });
    if (kaggleRes.ok) {
      kaggleData = await kaggleRes.json();
    }
  } catch (e) {
    console.error('Kaggle API error:', e);
  }
}

// 티어 숫자를 이름으로 변환
const tierNames = [
  "Unrated",
  "Bronze V",
  "Bronze IV",
  "Bronze III",
  "Bronze II",
  "Bronze I",
  "Silver V",
  "Silver IV",
  "Silver III",
  "Silver II",
  "Silver I",
  "Gold V",
  "Gold IV",
  "Gold III",
  "Gold II",
  "Gold I",
  "Platinum V",
  "Platinum IV",
  "Platinum III",
  "Platinum II",
  "Platinum I",
  "Diamond V",
  "Diamond IV",
  "Diamond III",
  "Diamond II",
  "Diamond I",
  "Ruby V",
  "Ruby IV",
  "Ruby III",
  "Ruby II",
  "Ruby I",
];
---

<Layout title="About Me" description="KT 소개" heroImage={AboutHeroImage}>
  <!-- Intro 섹션 -->
  <section class="profile-intro">
    <div class="profile-image">
      <img src="/images/profile.jpg" alt="프로필 사진" />
    </div>

    <div class="profile-text">
      <h2>안녕하세요, 김경태입니다.</h2>
      <p>
        이 블로그는 제가 공부한 내용을 정리하고 공유하기 위한 공간입니다.
        프론트엔드, 백엔드, 클라우드, AI 영역을 불문하고, IT 기술에 관심이
        많습니다.
      </p>
      <p>현재는 카카오테크 부트캠프에서 AI를 집중적으로 공부하고 있습니다.</p>
      <p>새로운 기술을 배우고 문제를 해결하는 과정을 즐깁니다.</p>
    </div>
  </section>

  <hr class="section-divider" />

  <!-- 경력사항 섹션 -->
  <section class="career-section">
    <h2>Experience</h2>
    <ul class="experience-list">
      <li class="experience-item">
        <div class="experience-header">
          <h3>한국전자기술연구원</h3>
          <span class="period">2021.07 - 2022.08</span>
        </div>
        <p class="position">연구원</p>
        <ul class="description">
          <li>유니티를 활용한 디지털트윈 환경 구축</li>
          <li>데이터 시각화</li>
        </ul>
      </li>
      <!-- 추가 경력 -->
    </ul>
  </section>

  <!-- 구분선 -->
  <hr class="section-divider" />

  <!-- 기타활동 섹션 -->
  <section class="activity-section">
    <h2>Activities</h2>
    <ul class="experience-list">
      <li class="experience-item">
        <div class="experience-header">
          <h3>컴퓨터응용소프트웨어 제 36대 학생회</h3>
          <span class="period">2021.11 - 2022.10</span>
        </div>
        <p class="position">학생회장</p>
        <ul class="description">
          <li>학과 학생회 운영</li>
        </ul>
      </li>
      <li class="experience-item">
        <div class="experience-header">
          <h3>웹개발 동아리 "원더독"</h3>
          <span class="period">2022.03 - 2022.07</span>
        </div>
        <p class="position">동아리원</p>
        <ul class="description">
          <li>Django 웹 개발</li>
        </ul>
      </li>
      <li class="experience-item">
        <div class="experience-header">
          <h3>자기주도적설계프로그램</h3>
          <span class="period">2018.03 - 2018.07</span>
        </div>
        <p class="position">팀장</p>
        <ul class="description">
          <li>"스마트 미러" 개발</li>
          <li>장려상 수상</li>
        </ul>
      </li>
    </ul>
  </section>

  <!-- 구분선 -->
  <hr class="section-divider" />

  <!-- 자격증 섹션 -->
  <section class="certification-section">
    <h2>Certifications</h2>
    <ul class="cert-list">
      <li class="cert-item">
        <div class="cert-info">
          <h3>정보처리기사</h3>
          <p class="cert-issuer">한국산업인력공단</p>
        </div>
        <span class="cert-date">2022.11</span>
      </li>
      <li class="cert-item">
        <div class="cert-info">
          <h3>SQLD</h3>
          <p class="cert-issuer">한국데이터산업진흥원</p>
        </div>
        <span class="cert-date">2024.06</span>
      </li>
    </ul>
  </section>

  <hr class="section-divider" />

  <!-- 기술 스택 섹션 -->
  <section class="tech-section">
    <h2>Tech Stack</h2>
    <div class="tech-category">
      <h3>Languages</h3>
      <div class="tech-badges">
        <span class="tech-badge"><img src="https://cdn.simpleicons.org/javascript/F7DF1E" alt="JavaScript" />JavaScript</span>
        <span class="tech-badge"><img src="https://cdn.simpleicons.org/typescript/3178C6" alt="TypeScript" />TypeScript</span>
        <span class="tech-badge"><img src="https://cdn.simpleicons.org/python/3776AB" alt="Python" />Python</span>
        <span class="tech-badge"><img src="https://cdn.simpleicons.org/openjdk/000000" alt="Java" />Java</span>
        <span class="tech-badge"><img src="https://cdn.simpleicons.org/c/A8B9CC" alt="C" />C</span>
        <span class="tech-badge"><img src="https://cdn.simpleicons.org/r/276DC3" alt="R" />R</span>
      </div>
    </div>
    <div class="tech-category">
      <h3>Frameworks</h3>
      <div class="tech-badges">
        <span class="tech-badge"><img src="https://cdn.simpleicons.org/react/61DAFB" alt="React" />React</span>
        <span class="tech-badge"><img src="https://cdn.simpleicons.org/nodedotjs/339933" alt="Node.js" />Node.js</span>
        <span class="tech-badge"><img src="https://cdn.simpleicons.org/spring/6DB33F" alt="Spring" />Spring</span>
      </div>
    </div>
    <div class="tech-category">
      <h3>Tools</h3>
      <div class="tech-badges">
        <span class="tech-badge"><img src="https://cdn.simpleicons.org/git/F05032" alt="Git" />Git</span>
        <span class="tech-badge"><img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/vscode/vscode-original.svg" alt="VS Code" />VS Code</span>
        <span class="tech-badge"><img src="https://cdn.simpleicons.org/docker/2496ED" alt="Docker" />Docker</span>
      </div>
    </div>
  </section>

  <hr class="section-divider" />

  <!-- 백준 티어 섹션 -->
  <section class="baekjoon-section">
    <h2>Algorithm</h2>
    <div class="algorithm-stats">
      <div class="algorithm-stat">
        <span class="algorithm-stat-label">Tier</span>
        <span class="algorithm-stat-value">{tierNames[data.tier]}</span>
      </div>
      <div class="algorithm-stat">
        <span class="algorithm-stat-label">Solved</span>
        <span class="algorithm-stat-value">{data.solvedCount}</span>
      </div>
      <div class="algorithm-stat">
        <span class="algorithm-stat-label">Rating</span>
        <span class="algorithm-stat-value">{data.rating}</span>
      </div>
    </div>
  </section>

  {kaggleData && (
    <>
      <hr class="section-divider" />
      <section class="kaggle-section">
        <h2>Kaggle</h2>
        <div class="algorithm-stats">
          <div class="algorithm-stat">
            <span class="algorithm-stat-label">Tier</span>
            <span class="algorithm-stat-value">{kaggleData.userTier || 'Novice'}</span>
          </div>
          <div class="algorithm-stat">
            <span class="algorithm-stat-label">Competitions</span>
            <span class="algorithm-stat-value">{kaggleData.totalCompetitions || 0}</span>
          </div>
          <div class="algorithm-stat">
            <span class="algorithm-stat-label">Datasets</span>
            <span class="algorithm-stat-value">{kaggleData.totalDatasets || 0}</span>
          </div>
          <div class="algorithm-stat">
            <span class="algorithm-stat-label">Notebooks</span>
            <span class="algorithm-stat-value">{kaggleData.totalNotebooks || 0}</span>
          </div>
        </div>
      </section>
    </>
  )}
</Layout>

<style>
  .profile-intro {
    display: flex;
    align-items: flex-start;
    gap: 3em;
    margin-bottom: 1em;
    padding: 1em;
    border-radius: 12px;
  }

  .profile-image img {
    max-width: 200px;
    width: 100%;
    height: auto;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }

  .profile-image .avatar {
    width: 200px;
    height: 200px;
    background: rgb(var(--accent));
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 4rem;
    font-weight: bold;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }

  .profile-text h2 {
    margin-top: 0;
    margin-bottom: 1em;
    font-size: 1.8rem;
    color: var(--color-text);
  }

  .profile-text p {
    line-height: 1.7;
    color: var(--color-text-secondary);
    margin-bottom: 1em;
  }

  @media (max-width: 768px) {
    .profile-intro {
      flex-direction: column;
      align-items: center;
      text-align: center;
    }
  }

  .experience-list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 2em;
  }

  .experience-item {
    padding: 1.5em;
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: 12px;
  }

  .experience-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 0.5em;
    gap: 1em;
  }

  .experience-header h3 {
    margin: 0;
    font-size: 1.2rem;
    color: var(--color-text);
  }

  .period {
    color: var(--color-text-secondary);
    font-size: 0.9rem;
    flex-shrink: 0;
  }

  .position {
    margin: 0 0 1em 0;
    color: var(--color-text);
    font-weight: 500;
  }

  .description {
    margin: 0;
    padding-left: 1.5em;
    color: var(--color-text-secondary);
  }

  .description li {
    margin-bottom: 0.5em;
    line-height: 1.5;
  }

  .career-section,
  .activity-section {
    margin-bottom: 1em;
  }

  .career-section h2,
  .activity-section h2 {
    margin-top: 1em;
    margin-bottom: 1em;
    font-size: 1.8rem;
    color: var(--color-text);
  }

  @media (max-width: 1024px) {
    .experience-section {
      grid-template-columns: 1fr;
    }
  }

  .certification-section {
    margin-bottom: 4em;
  }

  .certification-section h2 {
    margin-top: 1em;
    margin-bottom: 1em;
    font-size: 1.8rem;
    color: var(--color-text);
  }

  .cert-list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 1.5em;
  }

  .cert-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1.5em;
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: 12px;
  }

  .cert-info h3 {
    margin: 0 0 0.5em 0;
    font-size: 1.1rem;
    color: var(--color-text);
  }

  .cert-issuer {
    margin: 0;
    color: var(--color-text-secondary);
    font-size: 0.9rem;
  }

  .cert-date {
    color: var(--color-text);
    font-weight: 500;
    flex-shrink: 0;
    margin-left: 1em;
  }

  @media (max-width: 768px) {
    .cert-item {
      flex-direction: column;
      align-items: flex-start;
      gap: 0.5em;
    }
  }

  /* Tech Stack - Badge Style */
  .tech-section {
    margin-bottom: 2em;
  }

  .tech-section h2 {
    font-size: 1.8rem;
    margin-bottom: 1.5em;
    color: var(--color-text);
  }

  .tech-category {
    margin-bottom: 1.5em;
  }

  .tech-category h3 {
    font-size: 1rem;
    color: var(--color-text-secondary);
    margin-bottom: 0.75em;
    font-weight: 500;
  }

  .tech-badges {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5em;
  }

  .tech-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.5em;
    padding: 0.5em 1em;
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: 99px;
    font-size: 0.9rem;
    color: var(--color-text);
  }

  .tech-badge img {
    width: 16px;
    height: 16px;
  }

  /* Algorithm & Kaggle */
  .baekjoon-section,
  .kaggle-section {
    margin-bottom: 2em;
  }

  .baekjoon-section h2,
  .kaggle-section h2 {
    font-size: 1.8rem;
    margin-bottom: 1.5em;
    color: var(--color-text);
  }

  .algorithm-stats {
    display: flex;
    gap: 3em;
  }

  .algorithm-stat {
    display: flex;
    flex-direction: column;
    gap: 0.25em;
  }

  .algorithm-stat-label {
    font-size: 0.85rem;
    color: var(--color-text-secondary);
  }

  .algorithm-stat-value {
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--color-text);
  }

  @media (max-width: 480px) {
    .algorithm-stats {
      flex-direction: column;
      gap: 1em;
    }
  }
</style>
